{% extends 'base.html' %}
{% load i18n %}
{% load data_manipulation %}

<div>
{% block content %}

<style type="text/css" media="screen">
table {
  border-collapse: collapse;
  overflow-x: scroll;
  width: 80%px;
  display:block;
  font-size:10px;
}

td, th {
  border: 1px solid #999;
  padding: 0.5rem;
  text-align: left;
  min-width: 200px;
}

th td {
  font-weight: bold;
  text-align: center;
}

 th {
    padding: 5px;
    min-width: 0px;
    max-width: 85px;
    word-wrap: break-word;
}

 td {
    padding: 0px 5px;
    min-width: 0px;
    max-width: 150px;
}

</style>

<h1>{{ title }}</h1>

{% for name, stat in stats  %}

  <div class="stats">

    <h2>{{ name }}</h2>

      {% if stat.show_graph %}
        <p>Graph will come here later on</p>
      {% endif %}

      {# if you got frequency, you have a table with metrics #}
      {% if stat.frequency %}

        <table class="datatable datatable--basicstats">
          <thead>
            <tr>
              <th>{% trans "Value" %}</th>
              <th>{% trans "Frequency" %}</th>
              <th>{% trans "Percentage" %}</th>
            </tr>
          </thead>
          <tbody>

            {% for answer, _ in stat.frequency %}
            <tr>
                <td>
                {{ answer }}
                </td>

                <td>
                {{ stat.frequency|index:forloop.counter0|index:1 }}
                </td>

                <td> {{ stat.percentage|index:forloop.counter0|index:1 }}%</td>

            </tr>
            {% endfor %}

          </tbody>
        </table>

      {% endif %}

      {% if stat.mean %}

      <div class="datatable datatable--advancedstats">
        <table>
            <thead>
              <tr>
                <th>{% trans "Mean" %}</th>
                <th>{% trans "Median" %}</th>
                <th>{% trans "Mode" %}</th>
                <th>{% trans "Standard deviation" %}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                  <td> {{ stat.mean  }}</td>
                  <td> {{ stat.median  }}</td>
                  <td> {{ stat.mode  }}</td>
                  <td> {{ stat.stdev  }}</td>
              </tr>
            </tbody>
          </table>
      </div>

      {% endif %}

      <div class="datatable datatable--summarystats">
        <p>
          <span class="label">Total submissions</span>:
          <span class="value">{{ stat.total_count }}</span>
        </p>
        <p><span class="label">With data</span>:
          <span class="value">{{ stat.provided }}</span>
        </p>
        <p><span class="label">Without data</span>:
          <span class="value">{{ stat.not_provided }}</span>
        </p>
      </div>

    {% endfor %}

  </div>

<div id="pagination">
    {{ page.render }}
</div>

{% endblock %}
</div>

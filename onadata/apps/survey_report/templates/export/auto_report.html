{% extends 'base.html' %}
{% load i18n %}
{% load data_manipulation %}

<div>
{% block content %}

<style type="text/css" media="screen">
table {
  border-collapse: collapse;
  overflow-x: scroll;
  width: 80%px;
  display:block;
  font-size:10px;
}

td, th {
  border: 1px solid #999;
  padding: 0.5rem;
  text-align: left;
  min-width: 200px;
}

th td {
  font-weight: bold;
  text-align: center;
}

 th {
    padding: 5px;
    min-width: 0px;
    max-width: 85px;
    word-wrap: break-word;
}

 td {
    padding: 0px 5px;
    min-width: 0px;
    max-width: 150px;
}

</style>

<h1>{{ title }}</h1>

{% for name, stat in stats  %}

  <h2>{{ name }}</h2>

  {% if stat.show_graph %}
    <p>Graph will come here later on</p>
  {% endif %}

  {# if you got frequency, you have a table with metrics #}
  {% if stat.frequency %}

    <table>
      <thead>
        <tr>
          <th>{% trans "Value" %}</th>
          <th>{% trans "Frequency" %}</th>
          <th>{% trans "Pourcentage" %}</th>
        </tr>
      </thead>
      <tbody>

        {% for answer, _ in stat.frequency %}
        <tr>
            <td>
            {{ answer }}
            </td>

            <td>
            {{ stat.frequency|index:forloop.counter0|index:1 }}
            </td>

            <td> {{ stat.pourcentage|index:forloop.counter0|index:1 }}%</td>

        </tr>
        {% endfor %}

      </tbody>
    </table>

  {% endif %}

  {% if stat.mean %}

    <table>
      <thead>
        <tr>
          <th>{% trans "Value" %}</th>
          <th>{% trans "Mean" %}</th>
          <th>{% trans "Median" %}</th>
          <th>{% trans "Mode" %}</th>
          <th>{% trans "Standard deviation" %}</th>
        </tr>
      </thead>
      <tbody>
        {% for answer, _ in stat.frequency %}
        <tr>
            <td> {{ answer }} </td>
            <td> {{ stat.median|index:forloop.counter0|index:1 }}</td>
            <td> {{ stat.mean|index:forloop.counter0|index:1 }}</td>
            <td> {{ stat.mode|index:forloop.counter0|index:1 }}</td>
            <td> {{ stat.stdev|index:forloop.counter0|index:1 }}</td>
        </tr>
        {% endfor %}

      </tbody>
    </table>

  {% endif %}

  <p><strong>Total submissions</strong>: {{ stat.total_count }}</p>
  <p><strong>With data</strong>: {{ stat.provided }}</p>
  <p><strong>Without data</strong>: {{ stat.not_provided }}</p>

{% endfor %}

<div id="pagination">
    {{ page.render }}
</div>

{% endblock %}
</div>

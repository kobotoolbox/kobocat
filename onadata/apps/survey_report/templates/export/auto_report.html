{% extends 'base.html' %}
{% load i18n %}
{% load data_manipulation %}

<div>
{% block content %}

<style type="text/css" media="screen">
.stats h2 {
    font-size: 17px;
    color: #2196F3;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    max-width: 100%;
    margin: 1em 0 0.3em;
}

.stats p {
    margin: 0;
}

.stats span.label {
    padding: 0;
    background: none;
    color: black;
}

.datatable {
    display: table;
    width: 100%;
    font-size: 12px;
}

.datatable td, .datatable th {
    border-left: none;
    border-right: none;
    border-bottom: 1px solid #A5B3BC;
    text-align: left;
}

.datatable td {
    padding: 5px;
    min-width: 0px;
    max-width: 150px;
}

.datatable th {
    padding: 8px 5px;
}

.datatable td:nth-child(2), .datatable td:nth-child(3) {
    width: 25%;
}

.stats {
    margin: 0 10% 39px;
}

.datatable thead {
    background-color: #2196F3;
    color: white;
    font-weight: bold;
}

.datagraph {
    font-size: 10px;
    text-align: center;
    background-color: #eee;
    width: 80%;
    margin: 20px 10% 20px;
    height: 150px;
    padding-top: 100px;
}

.summarystats {
    color: #7D8A93;
    font-size: 11px;
}

.summarystats__provided {
    font-weight: bold;
}

.datatable--advancedstats {
    width: 80%;
    margin-left: 10%;
}
</style>

<h1>{{ title }}</h1>

{% for name, stat in stats  %}

  <div class="stats">

    <h2>{{ name }}</h2>

      <div class="summarystats">
        <p><span class="summarystats__provided">{{ stat.provided }}</span> out of {{ stat.total_count }} respondents answered this question ({{ stat.not_provided }} were without data)</p>
      </div>

      {% if stat.show_graph %}
        <div class="datagraph"><span>Graph will come here later on</span></div>
      {% endif %}

      {# if you got frequency, you have a table with metrics #}
      {% if stat.frequency %}

        <table class="datatable datatable--basicstats">
          <thead>
            <tr>
              <th>{% trans "Value" %}</th>
              <th>{% trans "Frequency" %}</th>
              <th>{% trans "Percentage" %}</th>
            </tr>
          </thead>
          <tbody>

            {% for answer, _ in stat.frequency %}
            <tr>
                <td>
                {{ answer }}
                </td>

                <td>
                {{ stat.frequency|index:forloop.counter0|index:1 }}
                </td>

                <td> {{ stat.percentage|index:forloop.counter0|index:1 }}%</td>

            </tr>
            {% endfor %}

          </tbody>
        </table>

      {% endif %}

      {% if stat.mean %}


        <table class="datatable datatable--advancedstats">
            <thead>
              <tr>
                <th>{% trans "Mean" %}</th>
                <th>{% trans "Median" %}</th>
                <th>{% trans "Mode" %}</th>
                <th>{% trans "Standard deviation" %}</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                  <td> {{ stat.mean  }}</td>
                  <td> {{ stat.median  }}</td>
                  <td> {{ stat.mode  }}</td>
                  <td> {{ stat.stdev  }}</td>
              </tr>
            </tbody>
          </table>


      {% endif %}


    </div>

{% endfor %}

<div id="pagination">
    {{ page.render }}
</div>

{% endblock %}
</div>
